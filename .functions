#!/usr/bin/env bash
function kp() {
  # kill process that is running on port $1
  sudo kill -9 $(sudo lsof -t -i:$1);
}

function gp() {
  # get process that is running on port $1
  sudo lsof -t -i:$1
}

function mkd() {
  # make directory $1 and enter it
  mkdir -p "$@" && cd "$_";
}

function fs() {
  # get file of current directory and descendants with size
  if du -b /dev/null > /dev/null 2>&1; then
    local arg=-sbh;
  else
    local arg=-sh;
  fi;
  if [[ -n "$@" ]]; then
    du $arg -- "$@";
  else
    du $arg .[^.]* ./*;
  fi;
}

function fr() {
  # argument 1 contains the directory to search in 
  # argument 2 is the regex string to replace
  # argument 3 is the replacement string
  find "$1" -type f -regex "$2" -exec sed -i '' -e "$3" {} +
}

function diff() {
  git diff --no-index --color-word "$@";
}

function ta() {
  # excecute command in all tmux panes
  for _pane in $(tmux list-panes -F '#P'); do
    for var in "$@"; do
      tmux send-keys -t ${_pane} $var;
      tmux send-keys -t ${_pane} Space;
    done;
    tmux send-key -t ${_pane} Enter;
  done;
}

function z() {
  d=$(date +'%Y%m%d')
  base_dir=$HOME/zet/$d
  mkdir $base_dir
  nvim $base_dir/README.adoc
  if [ ! -f "$base_dir/README.adoc" ]; then
    rm -r $base_dir
  fi
}

function rh() {
  # reset hard to branch $1
  git checkout $1
  git reset --hard origin/$1
}

